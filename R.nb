(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28694,        682]
NotebookOptionsPosition[     26285,        636]
NotebookOutlinePosition[     26720,        653]
CellTagsIndexPosition[     26677,        650]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Scalar curvature for the Quantum Metric Tensor", "Section",
 CellChangeTimes->{{3.8855686435026236`*^9, 
  3.885568652616233*^9}},ExpressionUUID->"fd517314-c429-47da-b95e-\
bdbdeb192924"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datg11", "=", 
   RowBox[{"Import", "[", "\"\<G11_j20.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datg12", "=", 
   RowBox[{"Import", "[", "\"\<G12_j20.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datg22", "=", 
   RowBox[{"Import", "[", "\"\<G22_j20.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datg", "=", 
   RowBox[{"Import", "[", "\"\<G_j20.csv\>\"", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8059163442032185`*^9, 3.805916395368113*^9}, {
   3.8059189736135707`*^9, 3.805918998802345*^9}, {3.805919279823147*^9, 
   3.805919297084115*^9}, {3.806002853250925*^9, 3.806002853547086*^9}, {
   3.8060065345875397`*^9, 3.8060065590296917`*^9}, {3.8062742298288374`*^9, 
   3.806274237305552*^9}, {3.80627431465586*^9, 3.8062743147964525`*^9}, {
   3.8063208389803534`*^9, 3.806320870940114*^9}, {3.8063211522706137`*^9, 
   3.806321156098488*^9}, {3.8065313863696985`*^9, 3.8065313904657493`*^9}, {
   3.810169045782158*^9, 3.810169060675849*^9}, {3.8103256029184675`*^9, 
   3.8103256061989517`*^9}, {3.8103828255999355`*^9, 
   3.8103828322235837`*^9}, {3.8108155404336367`*^9, 3.81081555805449*^9}, {
   3.810898448399922*^9, 3.810898470737526*^9}, {3.8121088113028507`*^9, 
   3.8121088217263727`*^9}, {3.8123909960856895`*^9, 3.812391003900838*^9}, {
   3.813678140157525*^9, 3.8136781659014363`*^9}, {3.813680311218782*^9, 
   3.813680316499432*^9}, {3.8136811376840687`*^9, 3.8136811413238387`*^9}, {
   3.814388946688835*^9, 3.8143889494394093`*^9}, {3.8143897304700346`*^9, 
   3.8143897332042356`*^9}, {3.814390258619617*^9, 3.814390264237968*^9}, {
   3.8143905424040127`*^9, 3.8143905473371344`*^9}, {3.814390947869339*^9, 
   3.814390951386894*^9}, {3.8143913739658833`*^9, 3.814391376668106*^9}, {
   3.8143956490623336`*^9, 3.814395652234527*^9}, {3.8143963701958303`*^9, 
   3.814396377783409*^9}, {3.8143999984521637`*^9, 3.8144000024036818`*^9}, {
   3.8144730921971116`*^9, 3.8144730962670937`*^9}, 3.814475725219035*^9, {
   3.8144759224361415`*^9, 3.8144759273932314`*^9}, {3.814480969870319*^9, 
   3.8144809743033304`*^9}, {3.814486866964342*^9, 3.8144868715723333`*^9}, {
   3.814528073465835*^9, 3.814528079970947*^9}, {3.8191455821177073`*^9, 
   3.8191455869759417`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5a3e11cd-3854-4808-9626-4951ba2578dc"],

Cell[CellGroupData[{

Cell["\<\
h \[Element] [ai,af] with step size \[CapitalDelta]1
\[Gamma] \[Element] [bi,bf] with step size \[CapitalDelta]2\
\>", "Subsection",
 CellChangeTimes->{{3.8033433262154775`*^9, 3.80334333568843*^9}, {
  3.8033434331787243`*^9, 3.8033434348037167`*^9}, {3.80338819620754*^9, 
  3.8033882127443886`*^9}, {3.803388289444532*^9, 3.8033883069953017`*^9}, {
  3.8033885236707983`*^9, 3.8033885469151025`*^9}, {3.8033885837007456`*^9, 
  3.8033886339769793`*^9}, {3.803388958758107*^9, 3.803388962149003*^9}, {
  3.803389139504988*^9, 3.803389140483968*^9}, {3.803389179378592*^9, 
  3.8033891824503827`*^9}, {3.803389303499132*^9, 3.8033893276181*^9}, {
  3.803397127206691*^9, 3.8033971922699356`*^9}, {3.8033973089299855`*^9, 
  3.803397359827046*^9}, {3.8035197237587614`*^9, 3.803519761675344*^9}, {
  3.80356825054317*^9, 3.8035683079687614`*^9}, {3.803578624876068*^9, 
  3.8035786627730637`*^9}, {3.8035856968077087`*^9, 3.803585700681658*^9}, {
  3.810169040304018*^9, 3.810169042204793*^9}, {3.819145661636724*^9, 
  3.8191456697091827`*^9}},ExpressionUUID->"c97ce54d-135e-4279-8bad-\
0270af19c20b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ai", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"af", "=", "0.9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bi", "=", 
   RowBox[{"-", "0.6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bf", "=", 
   RowBox[{"-", "0.4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]1", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]2", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hline", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "ai", ",", "af", ",", "\[CapitalDelta]1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]line", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"m", ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "bi", ",", "bf", ",", "\[CapitalDelta]2"}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8033895321186333`*^9, 3.803389556584276*^9}, {
   3.8033907490380116`*^9, 3.803390755828503*^9}, 3.803396673733303*^9, {
   3.803396802937316*^9, 3.803396833993168*^9}, 3.8033968718592443`*^9, {
   3.803396920457182*^9, 3.803396920847069*^9}, {3.803397198596572*^9, 
   3.803397246460309*^9}, {3.8033973363019905`*^9, 3.8033973958348455`*^9}, {
   3.8034020930681562`*^9, 3.8034021232791452`*^9}, 3.8034080418428288`*^9, 
   3.8034083162939544`*^9, {3.803424103549935*^9, 3.8034241055734653`*^9}, {
   3.8034304452405953`*^9, 3.8034304486460447`*^9}, {3.803430801286528*^9, 
   3.8034308044889*^9}, {3.8035197061721425`*^9, 3.8035197150141263`*^9}, {
   3.8035197721619787`*^9, 3.803519799058978*^9}, {3.803520057144932*^9, 
   3.8035200572226377`*^9}, {3.8035684299247837`*^9, 3.803568436017377*^9}, {
   3.803568481803461*^9, 3.803568537186739*^9}, {3.8035693381363716`*^9, 
   3.8035693612719107`*^9}, {3.8035694561567125`*^9, 3.80356946434242*^9}, {
   3.803569663587223*^9, 3.8035696697426353`*^9}, {3.8035698338477097`*^9, 
   3.803569835347723*^9}, 3.8035728574147673`*^9, {3.8035734003078284`*^9, 
   3.8035734013081236`*^9}, {3.803573436955378*^9, 3.8035734383150415`*^9}, {
   3.8035770704211197`*^9, 3.803577076795265*^9}, {3.8035771068266177`*^9, 
   3.8035771093260183`*^9}, {3.803578275073043*^9, 3.8035782825712614`*^9}, {
   3.803578611442601*^9, 3.80357861612932*^9}, {3.80360302641698*^9, 
   3.8036030344155874`*^9}, {3.8036041150208006`*^9, 
   3.8036041268298655`*^9}, {3.803604168685501*^9, 3.8036041689671926`*^9}, {
   3.8058348797108345`*^9, 3.8058348924452*^9}, {3.8059195169414353`*^9, 
   3.8059195361779304`*^9}, {3.8060065800798855`*^9, 
   3.8060065803141994`*^9}, {3.8060085799117174`*^9, 
   3.8060086034501905`*^9}, {3.8062742679092455`*^9, 
   3.8062742820042973`*^9}, {3.806320958236909*^9, 3.806321007306432*^9}, {
   3.806321069656642*^9, 3.806321079941345*^9}, 3.806321119636016*^9, {
   3.8063211693850746`*^9, 3.806321170947242*^9}, {3.8101690754208765`*^9, 
   3.8101690995193224`*^9}, {3.810382836073307*^9, 3.8103828401353474`*^9}, {
   3.810815561444337*^9, 3.810815562474661*^9}, {3.810898477620826*^9, 
   3.810898480573412*^9}, {3.812108824438657*^9, 3.8121088317482834`*^9}, {
   3.8123910082930512`*^9, 3.8123910303400917`*^9}, 3.8132597466591253`*^9, 
   3.813678131909466*^9, {3.8136803206390686`*^9, 3.8136803271993647`*^9}, 
   3.8136817283792095`*^9, {3.8143882226093354`*^9, 3.814388234071769*^9}, {
   3.8143889516733007`*^9, 3.8143889546969366`*^9}, {3.814389734954487*^9, 
   3.8143897378122883`*^9}, {3.8143902681161017`*^9, 3.8143902695507727`*^9}, 
   3.8143905500360765`*^9, {3.8143997233305016`*^9, 3.814399724957288*^9}, {
   3.8144731020856953`*^9, 3.8144731035996017`*^9}, {3.814475930300296*^9, 
   3.8144759303632355`*^9}, 3.8144868743223467`*^9, {3.8145280822102504`*^9, 
   3.814528084858141*^9}, {3.819145599835253*^9, 3.8191456061968184`*^9}, {
   3.8855686710520926`*^9, 3.8855686745732613`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7219db91-3d27-427c-8534-76f98185ab7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Converts the metric and determinant from 3-column format to mesh format\
\>", "Subsection",
 CellChangeTimes->{{3.8060033377611833`*^9, 3.806003350030512*^9}, {
   3.8060034424676433`*^9, 3.806003459238535*^9}, {3.8060042624683943`*^9, 
   3.806004262843306*^9}, {3.806004897668104*^9, 3.806004899558283*^9}, {
   3.8062556310860553`*^9, 3.80625563646185*^9}, {3.806531417206257*^9, 
   3.8065314195210695`*^9}, {3.8191456805809855`*^9, 3.8191457101843452`*^9}, 
   3.8191457594701242`*^9},ExpressionUUID->"32fcdd90-58a3-4002-9eb3-\
520bc6185f66"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g11", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g12", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g22", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ain", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bin", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Length", "[", "hline", "]"}], ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.805920846395282*^9, 3.8059208728069983`*^9}, {
  3.8060041489157734`*^9, 3.8060041526179886`*^9}, {3.806531427519685*^9, 
  3.8065314299392157`*^9}, {3.806531680931188*^9, 3.806531690663162*^9}, {
  3.806532193875804*^9, 3.80653221277827*^9}, {3.806532437345266*^9, 
  3.80653243760158*^9}, {3.810169103049548*^9, 3.810169106486436*^9}, {
  3.810169146109223*^9, 3.810169149624014*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"5f110c18-f19f-4caf-baa2-7515f16a75ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"g11", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"datg11", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"g12", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"datg12", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"g22", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"datg22", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"g", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{"datg", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", "3"}], "]"}], "]"}]}], ";", 
      RowBox[{"k", "++"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "hline", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "k", "]"}]}], "Input",
 CellChangeTimes->{{3.8059207445517373`*^9, 3.8059207804259787`*^9}, {
   3.805920837660283*^9, 3.805920840112853*^9}, {3.805920893067026*^9, 
   3.805920917176238*^9}, 3.8059209482232685`*^9, {3.805921499769864*^9, 
   3.8059215888022127`*^9}, {3.806003387187358*^9, 3.806003421140339*^9}, {
   3.8060042061232777`*^9, 3.8060042372962046`*^9}, 3.806254561021989*^9, {
   3.806531434736433*^9, 3.806531451024885*^9}, 3.810169108946884*^9, 
   3.8101691552006865`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"006f42be-a7fb-4e60-9312-ac791f179166"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computation of the scalar curvature", "Subsection",
 CellChangeTimes->{{3.8060038600988255`*^9, 3.80600387107001*^9}, {
  3.806004270986845*^9, 3.8060042776119356`*^9}, {3.806004748786865*^9, 
  3.8060047534760914`*^9}, {3.806254618524042*^9, 3.806254633841709*^9}, {
  3.806254673738609*^9, 3.8062546845339565`*^9}, {3.8065327121299157`*^9, 
  3.806532727259465*^9}, {3.8191457164020853`*^9, 
  3.819145721463614*^9}},ExpressionUUID->"1b9f1ad7-6d57-4809-afbc-\
010975c6d189"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Der10G11", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "g11"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Der01G11", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "g11"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Der10G12", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "g12"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Der10G22", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "g22"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.805922100717752*^9, 3.8059221088492517`*^9}, {
  3.8060038925569115`*^9, 3.806003997957388*^9}, {3.806004043324961*^9, 
  3.806004089799569*^9}, {3.806004408857792*^9, 3.80600440896714*^9}, {
  3.8062544339993086`*^9, 3.8062544536940055`*^9}, {3.8062545892149334`*^9, 
  3.806254610675654*^9}, {3.806254640889859*^9, 3.806254664705475*^9}, {
  3.8065315247996483`*^9, 3.806531569767378*^9}, {3.810169110946456*^9, 
  3.8101691128684883`*^9}, {3.8101691563099346`*^9, 3.8101691579658127`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"de90e64b-795d-47b9-8805-95b0eaa83d87"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Ain", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g12", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"g11", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"Der01G11", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
          RowBox[{"Der10G22", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}]}], ";", 
      RowBox[{
       RowBox[{"Bin", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"g", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"Der10G12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
          RowBox[{"Der01G11", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g12", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
             RowBox[{"g11", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}], " ", 
           RowBox[{"Der10G11", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}]}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "hline", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.806531629391972*^9, 3.806531654257535*^9}, {
   3.8065319386262226`*^9, 3.806532085558397*^9}, 3.8101691166957254`*^9, 
   3.810169161511841*^9, {3.8191485386262136`*^9, 3.819148596488289*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"61c2e3db-30fa-4423-9d4f-78d2cd5779e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "Ain"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"NDSolve`FiniteDifferenceDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hline", ",", "\[Gamma]line"}], "}"}], ",", "Bin"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8065322749913235`*^9, 3.8065323093684177`*^9}, 
   3.8065326932225027`*^9, {3.8101691196012936`*^9, 3.8101691202417536`*^9}, {
   3.8101691654321833`*^9, 3.810169166042041*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a4742f25-19d9-4df8-9511-eeb9889e2e68"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"R", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"g", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
         RowBox[{"B", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "hline", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.806532329895581*^9, 3.8065323587723336`*^9}, 
   3.8101691221006937`*^9, 3.810169167276109*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"7cd7e31c-1e10-49fd-8855-6dd72d7f9256"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "g11", ",", "g12", ",", "g22", ",", "g", ",", "Ain", ",", "Bin", ",", 
   "Der10G11", ",", "Der01G11", ",", "Der10G12", ",", "Der10G22", ",", "A", 
   ",", "B"}], "]"}]], "Input",
 CellChangeTimes->{{3.806005052266926*^9, 3.8060050589104047`*^9}, 
   3.8062545552523484`*^9, {3.8065323911587887`*^9, 3.806532427436798*^9}, {
   3.8065324586054273`*^9, 3.8065324590033617`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"803d8299-7fdb-4b7a-a4eb-be23b0e1d333"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Converts the scalar curvature from mesh format to 3-column format\
\>", "Subsection",
 CellChangeTimes->{{3.8060034743632946`*^9, 3.806003492177333*^9}, {
  3.8060048859310865`*^9, 3.8060048935413785`*^9}, {3.806255645937684*^9, 
  3.806255647506257*^9}, {3.8065323799955907`*^9, 3.8065323822994337`*^9}, {
  3.8191457333983088`*^9, 
  3.819145756267729*^9}},ExpressionUUID->"f7387b0a-df2e-4198-b0b6-\
d958f09ea405"],

Cell[BoxData[
 RowBox[{
  RowBox[{"datR", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{"0", "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "hline", "]"}], " ", 
        RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], ",", "3"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.805922283410988*^9, 3.805922296831643*^9}, {
   3.8060043257274685`*^9, 3.8060044307653513`*^9}, {3.8065324711070023`*^9, 
   3.806532474635573*^9}, 3.8101691294427366`*^9, 3.810169170869037*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"36fa0b28-5a83-473c-b942-7c0740b0e88c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"datR", ",", "k"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"hline", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"\[Gamma]line", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"R", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], ";", 
      RowBox[{"k", "++"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "\[Gamma]line", "]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "hline", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "k", "]"}]}], "Input",
 CellChangeTimes->{{3.8059221708022976`*^9, 3.805922173411044*^9}, {
   3.8059222188335547`*^9, 3.8059222193955665`*^9}, {3.8059222635374165`*^9, 
   3.8059222729120197`*^9}, {3.8059223066689963`*^9, 3.805922364868577*^9}, 
   3.8059224168322783`*^9, {3.806003375327649*^9, 3.806003379404814*^9}, {
   3.8060037899313173`*^9, 3.8060037930087166`*^9}, {3.8060044494854755`*^9, 
   3.806004465768132*^9}, {3.8060045670980625`*^9, 3.8060046918691344`*^9}, {
   3.806005209759338*^9, 3.806005211633896*^9}, 3.806254565445567*^9, {
   3.8065324827469225`*^9, 3.8065325157157793`*^9}, {3.8101691286456165`*^9, 
   3.810169130879616*^9}, {3.810169172399908*^9, 3.810169174743143*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"9eaa6db5-e801-4ca9-9147-d465f8479618"],

Cell[BoxData[
 RowBox[{"Clear", "[", "R", "]"}]], "Input",
 CellChangeTimes->{{3.806005825124359*^9, 3.8060058671675415`*^9}, 
   3.8062545705555334`*^9, 3.8065325038145576`*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"010a376c-4817-49c8-99f8-5ef61cc3a50b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<R_j20.csv\>\"", ",", "datR"}], "]"}]], "Input",
 CellChangeTimes->{{3.8060064292136803`*^9, 3.806006429463619*^9}, {
   3.8060065858454227`*^9, 3.806006586580267*^9}, {3.806274307076672*^9, 
   3.8062743072797356`*^9}, {3.8063212085235825`*^9, 3.806321214353068*^9}, {
   3.8101691811478524`*^9, 3.810169181490872*^9}, {3.8103256220865307`*^9, 
   3.8103256221952305`*^9}, {3.8103829079353447`*^9, 3.810382908075926*^9}, {
   3.810815572441723*^9, 3.8108155746443634`*^9}, {3.8108984859478407`*^9, 
   3.810898489349757*^9}, {3.8121088426105194`*^9, 3.812108845781276*^9}, {
   3.81239103787698*^9, 3.8123910384743857`*^9}, {3.813678205189725*^9, 
   3.8136782083139935`*^9}, 3.813680332792483*^9, 3.8136811437914867`*^9, 
   3.814388960228999*^9, {3.8143897415636764`*^9, 3.814389741611182*^9}, 
   3.8143902726309843`*^9, {3.814390553254098*^9, 3.814390553319922*^9}, 
   3.81439096192092*^9, 3.8143913795270777`*^9, {3.8143956568228965`*^9, 
   3.8143956568849297`*^9}, {3.8143963826602077`*^9, 
   3.8143963828783016`*^9}, {3.8144000066689653`*^9, 3.8144000066845703`*^9}, 
   3.814473108335441*^9, {3.814475936109333*^9, 3.8144759364213395`*^9}, {
   3.814480977023759*^9, 3.8144809781641054`*^9}, 3.814486879399248*^9, {
   3.814528093799709*^9, 3.814528095281953*^9}, {3.819145764812602*^9, 
   3.81914576704624*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"6faeb942-e581-4304-adb4-1d12fc4785b4"],

Cell[BoxData["\<\"R_j20.csv\"\>"], "Output",
 CellChangeTimes->{3.885568700367999*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"c633507b-1792-4875-aa15-282827faf86d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"datg11", ",", "datg12", ",", "datg22", ",", "datg", ",", "datR"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.814388961105338*^9, 3.814388966790022*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"13ec95f0-8c85-4c15-a620-1fb2e5a9cbc0"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{960, 472},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
Magnification:>1. Inherited,
FrontEndVersion->"13.2 for Microsoft Windows (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d1ac7ffd-83c2-42b4-a1b3-481eec8c480a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 193, 3, 67, "Section",ExpressionUUID->"fd517314-c429-47da-b95e-bdbdeb192924"],
Cell[776, 27, 2535, 45, 105, "Input",ExpressionUUID->"5a3e11cd-3854-4808-9626-4951ba2578dc"],
Cell[CellGroupData[{
Cell[3336, 76, 1112, 17, 81, "Subsection",ExpressionUUID->"c97ce54d-135e-4279-8bad-0270af19c20b"],
Cell[4451, 95, 4025, 70, 162, "Input",ExpressionUUID->"7219db91-3d27-427c-8534-76f98185ab7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8513, 170, 557, 9, 54, "Subsection",ExpressionUUID->"32fcdd90-58a3-4002-9eb3-520bc6185f66"],
Cell[9073, 181, 2557, 77, 143, "Input",ExpressionUUID->"5f110c18-f19f-4caf-baa2-7515f16a75ec"],
Cell[11633, 260, 1993, 52, 162, "Input",ExpressionUUID->"006f42be-a7fb-4e60-9312-ac791f179166"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13663, 317, 482, 7, 54, "Subsection",ExpressionUUID->"1b9f1ad7-6d57-4809-afbc-010975c6d189"],
Cell[14148, 326, 1787, 44, 86, "Input",ExpressionUUID->"de90e64b-795d-47b9-8805-95b0eaa83d87"],
Cell[15938, 372, 2771, 77, 74, "Input",ExpressionUUID->"61c2e3db-30fa-4423-9d4f-78d2cd5779e8"],
Cell[18712, 451, 862, 22, 48, "Input",ExpressionUUID->"a4742f25-19d9-4df8-9511-eeb9889e2e68"],
Cell[19577, 475, 1159, 33, 31, "Input",ExpressionUUID->"7cd7e31c-1e10-49fd-8855-6dd72d7f9256"],
Cell[20739, 510, 507, 9, 28, "Input",ExpressionUUID->"803d8299-7fdb-4b7a-a4eb-be23b0e1d333"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21283, 524, 426, 8, 54, "Subsection",ExpressionUUID->"f7387b0a-df2e-4198-b0b6-d958f09ea405"],
Cell[21712, 534, 625, 15, 28, "Input",ExpressionUUID->"36fa0b28-5a83-473c-b942-7c0740b0e88c"],
Cell[22340, 551, 1712, 38, 86, "Input",ExpressionUUID->"9eaa6db5-e801-4ca9-9147-d465f8479618"],
Cell[24055, 591, 257, 4, 28, "Input",ExpressionUUID->"010a376c-4817-49c8-99f8-5ef61cc3a50b"],
Cell[CellGroupData[{
Cell[24337, 599, 1457, 21, 28, "Input",ExpressionUUID->"6faeb942-e581-4304-adb4-1d12fc4785b4"],
Cell[25797, 622, 165, 2, 32, "Output",ExpressionUUID->"c633507b-1792-4875-aa15-282827faf86d"]
}, Open  ]],
Cell[25977, 627, 280, 5, 28, "Input",ExpressionUUID->"13ec95f0-8c85-4c15-a620-1fb2e5a9cbc0"]
}, Open  ]]
}, Open  ]]
}
]
*)

